{% extends "layouts/main.html" %}

{% set pageName="Home" %}

{% block content %}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">

    <h1 class="govuk-heading-xl spooky-heading">
      Record a ghost sighting
    </h1>

    <p class="govuk-body">
      Welcome to the <strong>Department for Supernatural Affairs</strong> service to record a ghost sighting.
      This haunted GOV.UK-style service contains intentional accessibility issues ‚Äî your job is to find them all.
    </p>

    <p class="govuk-body">
      Each page contains one or more accessibility issues (and perhaps a lurking ghost üëª).
    </p>

    {{ govukButton({
      text: "Start the haunted service",
      href: "/start",
      isStartButton: true
    }) }}

    <hr class="govuk-section-break govuk-section-break--xl govuk-section-break--visible">

    <h2 class="govuk-heading-m">Answers</h2>
    <p class="govuk-body">
      Enter the secret password to unlock the list of intentional accessibility issues.  
      (Hint: the ghosts will whisper clues to the password ‚Äî reveal them all to claim your <em>spooky</em> badge.)
    </p>

    <form id="password-form" class="govuk-form-group">
      <label class="govuk-label" for="trainer-password">Enter password</label>
      <input class="govuk-input govuk-input--width-20" id="trainer-password" type="password" name="trainer-password">
      <button class="govuk-button govuk-!-margin-top-2" type="submit">Unlock answers</button>
    </form>

    <div id="toggle-section" style="display: none; margin-top: 2rem;">
      <button class="govuk-button govuk-button--secondary" id="toggle-answers"
              type="button"
              aria-controls="answers-section"
              aria-expanded="false">
        Show answers
      </button>
    </div>

    <div id="answers-section" style="display: none; margin-top: 2rem;">
      <h2 class="govuk-heading-m">Pages in this prototype</h2>

      <table class="govuk-table">
        <thead class="govuk-table__head">
          <tr class="govuk-table__row">
            <th scope="col" class="govuk-table__header">Page name</th>
            <th scope="col" class="govuk-table__header">URL</th>
            <th scope="col" class="govuk-table__header">Intentional accessibility issues</th>
          </tr>
        </thead>
        <tbody class="govuk-table__body">

          <tr class="govuk-table__row">
            <td class="govuk-table__cell">Question 1 ‚Äì Witness details</td>
            <td class="govuk-table__cell"><a href="/question1">/question1</a></td>
            <td class="govuk-table__cell">
              <p><strong>Low contrast hint text</strong> ‚Äì text colour fails 1.4.3 contrast ratio.</p>
              <p><strong>Continue button not focusable</strong> ‚Äì <code>tabindex="-1"</code> prevents keyboard use (2.1.1).</p>
              <p><strong>Hidden focusable link</strong> ‚Äì invisible element reachable by keyboard (1.3.1).</p>
            </td>
          </tr>

          <tr class="govuk-table__row">
            <td class="govuk-table__cell">Question 2 ‚Äì Type of ghost sighting</td>
            <td class="govuk-table__cell"><a href="/question2">/question2</a></td>
            <td class="govuk-table__cell">
              <p><strong>No proper fieldset or legend</strong> ‚Äì checkboxes not semantically grouped (1.3.1).</p>
              <p><strong>Continue button not keyboard focusable</strong> ‚Äì cannot be reached via tab (2.1.1).</p>
            </td>
          </tr>

          <tr class="govuk-table__row">
            <td class="govuk-table__cell">Question 3 ‚Äì Date and location of sighting</td>
            <td class="govuk-table__cell"><a href="/question3">/question3</a></td>
            <td class="govuk-table__cell">
              <p><strong>Empty legend</strong> ‚Äì form fields lack clear group name (1.3.1).</p>
              <p><strong>Error messages not associated</strong> ‚Äì missing ARIA relationships (4.1.2).</p>
              <p><strong>Continue button not focusable</strong> ‚Äì keyboard users can‚Äôt activate it (2.1.1).</p>
            </td>
          </tr>

          <tr class="govuk-table__row">
            <td class="govuk-table__cell">Question 4 ‚Äì Description of sighting</td>
            <td class="govuk-table__cell"><a href="/question4">/question4</a></td>
            <td class="govuk-table__cell">
              <p><strong>Hidden focusable link</strong> ‚Äì disrupts logical focus order (2.4.3).</p>
              <p><strong>No character count or ARIA live region</strong> ‚Äì missing dynamic content feedback (4.1.3).</p>
            </td>
          </tr>

          <tr class="govuk-table__row">
            <td class="govuk-table__cell">Question 5 ‚Äì Supernatural activity intensity</td>
            <td class="govuk-table__cell"><a href="/question5">/question5</a></td>
            <td class="govuk-table__cell">
              <p><strong>No fieldset or legend</strong> ‚Äì radio buttons lack context (1.3.1).</p>
              <p><strong>Keyboard focus issue</strong> ‚Äì continue button not in tab order (2.4.3).</p>
            </td>
          </tr>

          <tr class="govuk-table__row">
            <td class="govuk-table__cell">Question 6 ‚Äì Upload evidence</td>
            <td class="govuk-table__cell"><a href="/question6">/question6</a></td>
            <td class="govuk-table__cell">
              <p><strong>Incorrectly associated label</strong> ‚Äì file input lacks explicit connection (1.3.1).</p>
              <p><strong>No text alternative for instruction</strong> ‚Äì missing clear guidance for screen readers (3.3.2).</p>
            </td>
          </tr>

          <tr class="govuk-table__row">
            <td class="govuk-table__cell">Check your answers</td>
            <td class="govuk-table__cell"><a href="/checkanswers">/checkanswers</a></td>
            <td class="govuk-table__cell">
              <p><strong>‚ÄúChange‚Äù links not descriptive</strong> ‚Äì lack visually hidden text (2.4.4).</p>
              <p><strong>Summary list missing caption</strong> ‚Äì unclear context for screen readers (1.3.1).</p>
            </td>
          </tr>

          <tr class="govuk-table__row">
            <td class="govuk-table__cell">Confirmation page</td>
            <td class="govuk-table__cell"><a href="/confirmation">/confirmation</a></td>
            <td class="govuk-table__cell">
              <p><strong>All caps heading</strong> ‚Äì reduces readability (1.4.8).</p>
              <p><strong>No clear return path</strong> ‚Äì poor navigation consistency (2.4.5).</p>
            </td>
          </tr>

          <tr class="govuk-table__row">
            <td class="govuk-table__cell">View your reports</td>
            <td class="govuk-table__cell"><a href="/tasklist">/tasklist</a></td>
            <td class="govuk-table__cell">
              <p><strong>Status indicated only by colour</strong> ‚Äì fails 1.4.1 use of colour.</p>
              <p><strong>Missing table caption</strong> ‚Äì sighted users see title but SR users do not (1.3.1).</p>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>
</div>

<script>
  const form = document.getElementById('password-form');
  const answersSection = document.getElementById('answers-section');
  const toggleSection = document.getElementById('toggle-section');
  const toggleButton = document.getElementById('toggle-answers');

  form.addEventListener('submit', function (event) {
    event.preventDefault();
    const password = document.getElementById('trainer-password').value.trim().toLowerCase();

    if (password === 'spooky') {
      toggleSection.style.display = 'block';
      form.style.display = 'none';
    } else {
      alert('üëª Incorrect password! The spirits are displeased. Try again.');
    }
  });

  toggleButton.addEventListener('click', function () {
    const visible = answersSection.style.display === 'block';
    answersSection.style.display = visible ? 'none' : 'block';
    toggleButton.textContent = visible ? 'Show answers' : 'Hide answers';
    toggleButton.setAttribute('aria-expanded', (!visible).toString());
  });
</script>

{% endblock %}
